const passive={passive:!0},rwdStyle=window.getComputedStyle(document.documentElement),rwdMin=parseFloat(rwdStyle.getPropertyValue("--rl")),rwdMax=parseFloat(rwdStyle.getPropertyValue("--rh")),rwdrange=rwdMax-rwdMin,rwd=()=>document.documentElement.style.setProperty("--r",Math.min(1,Math.max(0,parseFloat(window.getComputedStyle(document.documentElement,"::before").getPropertyValue("width"))-rwdMin)/rwdrange).toString());rwd(),window.addEventListener("resize",rwd,passive);const settingsData={border_width:"",theme:"",contrast:"",data:""},loadedSettingsData=JSON.parse(sessionStorage.getItem("settings")??localStorage.getItem("settings")??"{}");for(const settingKey of Object.keys(settingsData))loadedSettingsData[settingKey]&&(settingsData[settingKey]=loadedSettingsData[settingKey]);const Settings=()=>{for(let e of(window.so.addEventListener("click",e=>{window.sd.showModal(),document.body.classList.add("so"),window.sd.children[0].scrollTo(0,0)}),window.sc.addEventListener("click",e=>{window.sd.close(),document.body.classList.remove("so")}),SettingsUpdateForm(),window.sout.textContent=sessionStorage.getItem("settings")??localStorage.getItem("settings")??"",Object.keys(settingsData)))if(window.sf.elements[e][0])for(let t=0;t<window.sf.elements[e].length;t++)window.sf.elements[e][t].addEventListener("change",OnSettingsChange);else window.sf.elements[e].addEventListener("change",OnSettingsChange);window.sdel.addEventListener("click",e=>{for(let t of(localStorage.removeItem("settings"),sessionStorage.removeItem("settings"),Object.keys(settingsData)))settingsData[t]="";window.sout.textContent="",SettingsUpdateForm(),SettingsApply()}),window.sf.addEventListener("submit",e=>e.preventDefault())},SettingsApply=()=>{document.documentElement.classList.toggle("csd","dark"==settingsData.theme),document.documentElement.classList.toggle("csl","light"==settingsData.theme),document.documentElement.classList.toggle("csch","more"==settingsData.contrast),document.documentElement.classList.toggle("cscl","less"==settingsData.contrast),document.body.style.setProperty("--bw",`var(--b${settingsData.border_width||"1"})`)},SettingsUpdateForm=()=>{for(let e of Object.keys(settingsData))if(window.sf.elements[e][0])for(let t=0;t<window.sf.elements[e].length;t++)window.sf.elements[e][t].checked=window.sf.elements[e][t].value==settingsData[e];else window.sf.elements[e].value=settingsData[e]},OnSettingsChange=e=>{if(localStorage.removeItem("settings"),sessionStorage.removeItem("settings"),settingsData[e.target.name]=e.target.value??"",settingsData.data){let t={};for(let[s,n]of Object.entries(settingsData))n&&(t[s]=n);Object.keys(t).length&&("local_storage"==settingsData.data?localStorage.setItem("settings",JSON.stringify(t)):sessionStorage.setItem("settings",JSON.stringify(t)))}SettingsApply(),window.sout.textContent=sessionStorage.getItem("settings")??localStorage.getItem("settings")??""},ScrollbarWidth=()=>{let e=document.createElement("div");e.style.setProperty("overflow","scroll"),e.style.setProperty("position","absolute"),e.style.setProperty("left","-300vw"),document.body.appendChild(e),document.documentElement.style.setProperty("--sw",e.offsetWidth.toString()),document.body.removeChild(e)},UpdateBodyHasScrollbar=()=>{document.body.classList.toggle("sw",window.innerWidth>document.documentElement.clientWidth)},CSSVars=()=>{ScrollbarWidth(),UpdateBodyHasScrollbar(),window.addEventListener("resize",ScrollbarWidth,passive),window.addEventListener("resize",UpdateBodyHasScrollbar,passive)},ViewTransitions=()=>{if(!("startViewTransition"in document))return;let e=location.href.lastIndexOf("#"),t=-1==e?location.href:location.href.slice(0,e),s="a:not([href='#content']):not([href^='mailto']):not(.nvt)",n=null,l=null,a=null,r=async(e,t=!1)=>{document.body.classList.add("is-loading");try{let r=document.startViewTransition(async()=>{l=e,a=new AbortController;let s=fetch(l,{signal:a.signal});t&&history.pushState(null,"",e);let n=document.querySelector("#h"),r=document.querySelector("#content"),i=document.querySelector("#f"),o=document.createElement("div");if(!(s=await s).ok)throw document.title="404",r.innerHTML="<h1>404</h1>",Error("404");o.innerHTML=await s.text(),l=null,a=null,n.replaceWith(o.querySelector("#h")),r.replaceWith(o.querySelector("#content")),i.replaceWith(o.querySelector("#f")),document.title=o.querySelector("title").textContent});await r.updateCallbackDone,t&&window.scrollTo(0,0),UpdateBodyHasScrollbar(),"undefined"!=typeof OptionalSyntaxHighlighting&&OptionalSyntaxHighlighting(),MouseEffects(),document.querySelectorAll(s).forEach(e=>e.addEventListener("click",i)),n=location.href,document.documentElement.dispatchEvent(new CustomEvent("viewchange"))}catch(o){console.debug(o)}document.body.classList.remove("is-loading")},i=e=>{if(e.preventDefault(),(e.target.host??location.host)!=location.host)return;let s=location.href.lastIndexOf("#"),l=-1==s?e.target.href:e.target.href.slice(0,s);t!=l&&(t=l,e.preventDefault(),n=location.href,r(e.target.href,!0))},o=e=>{let s=location.href.lastIndexOf("#"),i=-1==s?location.href:location.href.slice(0,s);if(t!=i)t=i,e.preventDefault(),(null===l||(a.abort(),l=null,n!=location.href))&&r(location.href)};document.querySelectorAll(s).forEach(e=>e.addEventListener("click",i)),window.addEventListener("popstate",o)};document.addEventListener("readystatechange",e=>{if(UpdateBodyHasScrollbar(),"complete"!=document.readyState)return;"showPopover"in sp?sp.showPopover():sp.style="position:fixed;top:100%;left:100%;transform:translate(-100%,-100%)translateZ(1px);z-index:9999;",MouseEffects(),ViewTransitions(),Settings();let t;var s=()=>{if(!navigator.connection?.saveData){if(t){hljs.highlightAll();return}if(!document.querySelector("pre code"))return;let e=document.createElement("script");e.src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js",document.head.appendChild(e),e.addEventListener("load",()=>{t=!0,hljs.highlightAll()});let s=document.createElement("link");s.rel="stylesheet",s.href="/hljs.css",document.head.appendChild(s)}};navigator.connection?.saveData||(document.documentElement.addEventListener("viewchange",s),s())});const mouseEffectsNodes=new Set,UpdateMouseEffects=e=>{for(let t of mouseEffectsNodes){let s=t.getBoundingClientRect();t.style.setProperty("--mpxt",`${e.clientY-s.top}px`),t.style.setProperty("--mpxl",`${e.clientX-s.left}px`),t.classList.add("mset")}},MouseEffects=()=>{if(!("ontouchstart"in document.documentElement)){for(let e of document.querySelectorAll(".m, button, pre code"))mouseEffectsNodes.add(e);addEventListener("mousemove",UpdateMouseEffects,{passive:!0})}};
